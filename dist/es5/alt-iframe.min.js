/**
 * alt-iframe
 * - A simple native JavaScript (ES5) utility library to include partial HTML(s).
 * - You don't need a framework or jQuery!!!
 *
 * version: 1.6.1-ES5
 *
 * License: MIT
 *
 * USAGE:
 * see example at https://github.com/FrontEndNeo/alt-iframe
*/
(function(t){function e(t,e){return e="string"==typeof e&&M.querySelector(e)||e||M,Array.prototype.slice.call(e.querySelectorAll(t))}function r(t,e,r){t.setAttribute(r,t.getAttribute(e)),t.removeAttribute(e)}function i(t){var e=M.createElement("script");e.text=t.innerHTML.replace(/&gt;/gi,">").replace(/&lt;/gi,"<").replace(/&amp;/gi,"&").replace(/&quot;/gi,'"').replace(/&apos;/gi,"'");for(var r=t.attributes.length-1;r>=0;r--)e.setAttribute(t.attributes[r].name,t.attributes[r].value);return e}function a(t,a){
// getElements('x-script:not([processed])', context).forEach(function(xScript){
e("script:not([processed])",t).forEach(function(t){t.setAttribute("processed",""),a&&t.setAttribute("await","");var e=i(t);if(e.hasAttribute("src")){var n=!e.hasAttribute("await");!a&&n?t.parentNode.replaceChild(e,t):(r(t,"src","x-src"),l(e))}else t.parentNode.replaceChild(e,t)})}function n(){var t,e=(M.body.getAttribute("hash-error")||"").toLowerCase(),r=N.origin+N.pathname+N.search;"url"==e?(t="Page_route["+L.substring(1)+"]_not_found!_Redirected_to_this_page_root.",r=N.origin+N.pathname+"?_error="+t+N.search.replace(/^\?/,"&")):(t="Page route[#"+L.substring(1)+"] not found! Redirecting to this page root.",alert(t)),N.href=r}function s(t,r){if(q)if(t=t||L,t){var i=e('[url-hash="'+t+'"][x-target^="#"],[href="'+t+'"]');if(i.length)r&&i[0].setAttribute("skip-hash-update","1"),(!r||S&&r==L)&&(L=""),T=R,f.call(i[0],!0,r);else if(!E)if(L.indexOf(O)>0){var a=(F&&F.split(O)||[]).length,o=k[a];o||a<=k.length?(F+=(F?O:"")+o,S=e('[url-hash="'+F+'"][x-target^="#"]').length?0:250,setTimeout(function(){s(F,L)},S)):n()}else if(!g().length){var u=M.querySelector(L);u?(u.scrollIntoView(!0),L=""):n()}}else{var c=e("[skip-on-hash]");c.length&&(c.forEach(function(t){t.removeAttribute("skip-on-hash")}),p())}}function o(t,e){E--;var r=t.getAttribute("x-js");if(r&&(e+='<script src="'+r+'"></script>',t.removeAttribute("x-js")),"SCRIPT"==t.tagName){if(e.trim()){var i=M.createElement("script");i.id=(new Date).getMilliseconds(),i.text=e,M.head.appendChild(i).parentNode.removeChild(i)}}else
// .replace(/<(\/)*script/gi, '<$1x-script');
if(e=e||"",t.tagName.indexOf("REPLACE")>=0||t.hasAttribute("replace")){var n=t.parentNode,o=t.hasAttribute("await");t.outerHTML=e,a(n,o),p(n)}else t.innerHTML=e,a(t,t.hasAttribute("await")),p(t);s()}function u(){if(4==this.readyState){var t=this.status,e=t>=200&&t<300||304==t?this.responseText:"Cannot GET "+this.responseURL;o(this.targetEl,e)}}function c(t){var e=(t||"").trim(),r="";return/^(\/\/|http:\/\/|https:\/\/)/i.test(e)||(r=/\+$/.test(e)?"+":"",r&&(e=e.substring(0,e.length-1)),w&&(e=/^[^a-z0-9_]/gi.test(e[0])?e.substring(1):w+"/"+e),x&&(e="/"==e[e.length-1]?e.substring(0,e.length-1):e+x)),e+r}function l(t,e){if(e=c(e||t.getAttribute("src")),t.setAttribute("x-src",e),t.removeAttribute("src"),e){E++,/\+$/.test(e)&&(//appendScript
t.setAttribute("x-js",e.replace(/\.[a-z]{3,4}\+$/,".js")),e=e.substring(0,e.length-1));var r=new XMLHttpRequest;r.targetEl=t,r.onreadystatechange=u,r.open("GET",e,!t.hasAttribute("await")),r.send()}}function h(t){if(q){if(!t.getAttribute("skip-hash-update")){var e=t.getAttribute("url-hash");if("#"!=e&&T!=e){T=e;try{history.pushState(null,e,e)}catch(t){}}}t.removeAttribute("skip-hash-update")}}function f(t,e){var r=this;if(t&&e&&"FORM"!==r.tagName)r.click();else{if("FORM"==r.tagName&&!r.checkValidity())return r.reportValidity(),!1;var i=r.getAttribute("if");if(i){var a=i.indexOf("("),n=(a>0?i.substring(0,a):i).replace(/\s/g,"");if(n){var s;try{s=window[n].call(r)}catch(t){console.error("Function NOT Found:",n)}if(!s)return!1}}var o=M.querySelector(r.getAttribute("x-target"));if(o){o[r.hasAttribute("replace")?"setAttribute":"removeAttribute"]("replace",""),r.hasAttribute("await")&&o.setAttribute("await",""),r.hasAttribute("async")&&o.removeAttribute("await",""),h(r);var u=r.getAttribute("x-href").substring(1);/^[! ]/.test(u)&&(u=u.substring(1).trim()),l(o,u)}else console.warn("Target element not found. Invalid target specified in element",r)}}function g(t){return t=t||M,e("[src]"+"audio embed iframe img input script source track video [processed] [skip-on-hash]".split(" ").map(function(t){return":not("+t+")"}).join(""),t)}function p(t){t=t||M;var i=g(t);i.forEach(function(t){t.setAttribute("processed",""),l(t)}),e("form:not([onsubmit]):not([href])",t).forEach(function(t){!t.getAttribute("action")&&t.setAttribute("onsubmit","return false;")}),e('[href^="#"][target^="#"]',t).forEach(function(t){r(t,"target","x-target"),r(t,"href","x-href"),t.setAttribute("href","javascript:;");var e=t.getAttribute("url-hash")||t.getAttribute("x-href");!/^#/.test(e)&&(e="#"+e),/^#[! ]+/.test(e)&&(e="#"),e=e.replace(/[+ ]/g,"").replace(new RegExp("\\"+O+"+$"),""),t.setAttribute("url-hash",e);var i="FORM"==t.tagName,a=i?"submit":"click",n=(t.getAttribute("on")||a).replace(/[^a-z]/gi,"_");i&&!t.getAttribute("onsubmit")&&t.setAttribute("onsubmit","return false;"),n.split("_").forEach(function(e){e=e.trim().toLowerCase(),e.length>2&&(e=e.replace(/^on/,""),t.addEventListener(e,f))})}),!i.length&&m()}function b(){if(4==this.readyState){var t=this.status,e=t>=200&&t<300||304==t?this.responseText:'{"error":"Failed: [GET]'+this.responseURL+'", "status": '+t+"}";this.callbackFn(JSON.parse(e))}}function d(t,e){var r=new XMLHttpRequest;r.callbackFn=e,r.onreadystatechange=b,r.open("GET",t),r.send()}function A(t,r,i){var a=e(r)[0];a?("function"==typeof i&&j.push(i),l(a,t)):console.error("Target container not found.",r)}function v(t){"function"==typeof t&&(j.push(t),m())}function m(){E||g().length||!j.length||void 0!==C&&!C||(_=j.shift(),C=_(C),void 0!==C&&!C&&(j=[]),m())}function y(){E=0,L=N.hash||"",k=q&&L&&L.split(O)||[],w=(M.body.getAttribute("components-loc")||"").replace(/\/+$/g,"").trim(),x=(M.body.getAttribute("components-ext")||"").trim(),p(),setTimeout(function(){new MutationObserver(function(t){t&&t[0]&&"childList"===t[0].type&&t[0].target&&p(t[0].target)}).observe(M,{childList:!0,subtree:!0})})}var w,x,E,L,T,R,k,S,_,C,M=document,N=M.location,O="/",F="",q="off"!=(M.body.getAttribute("url-hash")||"").toLowerCase(),j=[];q&&(window.onhashchange=function(){R=N.hash||"",R?R!=T&&(L=R,s()):(N.href.indexOf("#")<0&&N.reload(),T="#")}),"complete"==M.readyState||"loading"!=M.readyState&&!M.documentElement.doScroll?y():M.addEventListener("DOMContentLoaded",y),t.alt=t.aif={load:A,onReady:v,getData:d}})(this);