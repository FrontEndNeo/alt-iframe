/**
 * alt-iframe
 * - A simple native JavaScript (ES5) utility library to include partial HTML(s).
 * - You don't need a framework or jQuery!!!
 *
 * version: 1.8.0-ES5
 *
 * License: MIT
 *
 * USAGE:
 * see example at https://github.com/FrontEndNeo/alt-iframe
*/
(function(t){function e(t,e){return e="string"==typeof e&&N.querySelector(e)||e||N,Array.prototype.slice.call(e.querySelectorAll(t))}function r(t,e,r){t.setAttribute(r,t.getAttribute(e)),t.removeAttribute(e)}function i(t){var e=N.createElement("script");e.text=t.innerHTML;for(var r=t.attributes.length-1;r>=0;r--)e.setAttribute(t.attributes[r].name,t.attributes[r].value);return e}function n(t,e,r){var i,n,s,a,o=oldSrc=(t.getAttribute(e)||"").trim();2===arguments.length&&(r=t.closest("[x-src]")),o&&r&&!/^(\/\/|http:\/\/|https:\/\/)/i.test(o)&&(i=R.replace(/^\/+/,""),n=new RegExp("^((.){0,2}/)*"+i),n.test(o)?o=o.replace(n,R):"/"!==o[0]&&(s=r&&r.getAttribute("x-src")||"",a=s.substring(0,s.lastIndexOf("/")+1)||R+"/",o=(a+o).replace(/\/\.?\//,"/"))),o!==oldSrc&&console.log(o,oldSrc),o!==oldSrc&&t.setAttribute(e,o)}function s(t,s){e("script:not([processed])",t).forEach(function(t){t.setAttribute("processed",""),s&&t.setAttribute("await","");var e=i(t);if(e.hasAttribute("src")){n(e,"src",t.closest("[x-src]"));var a=e.getAttribute("src");!/\.js$/i.test(a)&&e.setAttribute("src",a+".js");var o=!e.hasAttribute("await");!s&&o?t.parentNode.replaceChild(e,t):(r(t,"src","x-src"),g(e))}else t.parentNode.replaceChild(e,t)})}function a(t){e('link[rel="stylesheet"][href]:not([processed])',t).forEach(function(t){n(t,"href"),t.setAttribute("processed","")}),e("img[src]:not([processed])",t).forEach(function(t){n(t,"src"),t.setAttribute("processed","")})}function o(){var t,e=(N.body.getAttribute("hash-error")||"").toLowerCase(),r=F.origin+F.pathname+F.search;"url"==e?(t="Page_route["+T.substring(1)+"]_not_found!_Redirected_to_this_page_root.",r=F.origin+F.pathname+"?_error="+t+F.search.replace(/^\?/,"&")):(t="Page route[#"+T.substring(1)+"] not found! Redirecting to this page root.",alert(t)),F.href=r}function u(t,r){if(q)if(t=t||T,t){var i=e('[url-hash="'+t+'"][x-target^="#"],[href="'+t+'"]');if(i.length)r&&i[0].setAttribute("skip-hash-update","1"),(!r||_&&r==T)&&(T=""),O=k,d.call(i[0],!0,r);else if(!S)if(T.indexOf(j)>0){var n=($&&$.split(j)||[]).length,s=C[n];s||n<=C.length?($+=($?j:"")+s,_=e('[url-hash="'+$+'"][x-target^="#"]').length?0:250,setTimeout(function(){u($,T)},_)):o()}else if(!b().length){var a=N.querySelector(T);a?(a.scrollIntoView(!0),T=""):o()}}else{var c=e("[skip-on-hash]");c.length&&(c.forEach(function(t){t.removeAttribute("skip-on-hash")}),A())}}function c(t,e){S--;var r=t.getAttribute("x-js");if(r&&(e+='<script src="'+r+'"></script>',t.removeAttribute("x-js")),"SCRIPT"==t.tagName){if(e.trim()){var i=N.createElement("script");i.id=(new Date).getMilliseconds(),i.text=e,N.head.appendChild(i).parentNode.removeChild(i)}}else{var n=t.hasAttribute("replace")||t.tagName.indexOf("REPLACE")>=0,o=n?t.parentNode:t,c=n?"outerHTML":"innerHTML",l=t.hasAttribute("await");e=e||"",t[c]=e,a(o),s(o,l),A(o)}u()}function l(){if(4==this.readyState){var t=this.status,e=t>=200&&t<300||304==t?this.responseText:"Cannot GET "+this.responseURL;c(this.targetEl,e)}}function h(t){if("?"===R&&t.indexOf("/")>=0){var e=t.indexOf("/"),r=t.indexOf("/",e+1);R=("/"===t[0]||"."===t[0])&&r>e?t.substring(0,r):t.substring(0,e),console.log("Components Root Folder:",R)}}function f(t){var e,r,i=(t||"").trim(),n="";return/^(\/\/|http:\/\/|https:\/\/)/i.test(i)||(n=/\+$/.test(i)?"+":"",n&&(i=i.substring(0,i.length-1)),h(i),R&&(/^[^a-z0-9_\.\/]/gi.test(i[0])?i=i.substring(1):(e=R.replace(/^\/+/,""),r=new RegExp("^((.){0,2}/)*"+e),i=r.test(i)?i.replace(r,R):(R+"/"+i).replace(/\/\.?\//,"/"))),L&&!new RegExp(L+"$").test(i)&&(i="/"==i[i.length-1]?i.substring(0,i.length-1):i+L)),i+n}function g(t,e){if(e=f(e||t.getAttribute("src")),t.setAttribute("x-src",e),t.removeAttribute("src"),e){S++,/\+$/.test(e)&&(//appendScript
t.setAttribute("x-js",e.replace(/\.[a-z]{3,4}\+$/,".js")),e=e.substring(0,e.length-1));var r=new XMLHttpRequest;r.targetEl=t,r.onreadystatechange=l,r.open("GET",e,!t.hasAttribute("await")),r.send()}}function p(t){if(q){if(!t.getAttribute("skip-hash-update")){var e=t.getAttribute("url-hash");if("#"!=e&&O!=e){O=e;try{history.pushState(null,e,e)}catch(t){}}}t.removeAttribute("skip-hash-update")}}function d(t,e){var r=this;if(t&&e&&"FORM"!==r.tagName)r.click();else{if("FORM"==r.tagName&&!r.checkValidity())return r.reportValidity(),!1;var i=r.getAttribute("if");if(i){var n=i.indexOf("("),s=(n>0?i.substring(0,n):i).replace(/\s/g,"");if(s){var a;try{a=window[s].call(r)}catch(t){console.error("Function NOT Found:",s)}if(!a)return!1}}var o=N.querySelector(r.getAttribute("x-target"));if(o){o[r.hasAttribute("replace")?"setAttribute":"removeAttribute"]("replace",""),r.hasAttribute("await")&&o.setAttribute("await",""),r.hasAttribute("async")&&o.removeAttribute("await",""),p(r);var u=r.getAttribute("x-href").substring(1);/^[! ]/.test(u)&&(u=u.substring(1).trim()),g(o,u)}else console.warn("Target element not found. Invalid target specified in element",r)}}function b(t){return t=t||N,e("[src]"+"audio embed iframe img input script source track video [processed] [skip-on-hash]".split(" ").map(function(t){return":not("+t+")"}).join(""),t)}function A(t){t=t||N;var i=b(t);i.forEach(function(t){t.setAttribute("processed",""),g(t)}),e("form:not([onsubmit]):not([href])",t).forEach(function(t){!t.getAttribute("action")&&t.setAttribute("onsubmit","return false;")}),e('[href^="#"][target^="#"]',t).forEach(function(t){r(t,"target","x-target"),r(t,"href","x-href"),t.setAttribute("href","javascript:;");var e=t.getAttribute("url-hash")||t.getAttribute("x-href");!/^#/.test(e)&&(e="#"+e),/^#[! ]+/.test(e)&&(e="#"),e=e.replace(/[+ ]/g,"").replace(new RegExp("\\"+j+"+$"),""),t.setAttribute("url-hash",e);var i="FORM"==t.tagName,n=i?"submit":"click",s=(t.getAttribute("on")||n).replace(/[^a-z]/gi,"_");i&&!t.getAttribute("onsubmit")&&t.setAttribute("onsubmit","return false;"),s.split("_").forEach(function(e){e=e.trim().toLowerCase(),e.length>2&&(e=e.replace(/^on/,""),t.addEventListener(e,d))})}),!i.length&&E()}function v(){if(4==this.readyState){var t=this.status,e=t>=200&&t<300||304==t?this.responseText:'{"error":"Failed: [GET]'+this.responseURL+'", "status": '+t+"}";this.callbackFn(JSON.parse(e))}}function m(t,e){var r=new XMLHttpRequest;r.callbackFn=e,r.onreadystatechange=v,r.open("GET",t),r.send()}function x(t,r,i){var n=e(r)[0];n?("function"==typeof i&&H.push(i),g(n,t)):console.error("Target container not found.",r)}function y(t,e){"function"==typeof t&&(H.push({fn:t,delay:e||0}),E())}function E(t){S||b().length||!H.length||void 0!==t&&!t||(M=H.shift(),setTimeout(function(){var e=M.fn(t);void 0!==e&&!e&&(H=[]),E(e)},M.delay))}function w(){S=0,T=F.hash||"",C=q&&T&&T.split(j)||[],R=(N.body.getAttribute("components-loc")||"").replace(/^\.\//,"").replace(/\/+$/g,"").trim(),L=(N.body.getAttribute("components-ext")||"").trim(),A(),setTimeout(function(){new MutationObserver(function(t){t&&t[0]&&"childList"===t[0].type&&t[0].target&&A(t[0].target)}).observe(N,{childList:!0,subtree:!0})})}var R,L,S,T,O,k,C,_,M,N=document,F=N.location,j="/",$="",q="off"!=(N.body.getAttribute("url-hash")||"").toLowerCase(),H=[];q&&(window.onhashchange=function(){k=F.hash||"",k?k!=O&&(T=k,u()):(F.href.indexOf("#")<0&&F.reload(),O="#")}),"complete"==N.readyState||"loading"!=N.readyState&&!N.documentElement.doScroll?w():N.addEventListener("DOMContentLoaded",w),t.alt=t.aif={load:x,onReady:y,getData:m}})(this);