/**
 * alt-iframe
 * - A simple native JavaScript (ES5) utility library to include partial HTML(s).
 * - You don't need a framework or jQuery!!!
 *
 * version: 1.8.1-ES5
 *
 * License: MIT
 *
 * USAGE:
 * see example at https://github.com/FrontEndNeo/alt-iframe
*/
(function(t){function e(t,e){return e="string"==typeof e&&j.querySelector(e)||e||j,Array.prototype.slice.call(e.querySelectorAll(t))}function r(t,e,r){t.setAttribute(r,t.getAttribute(e)),t.removeAttribute(e)}function i(t){var e=j.createElement("script");e.text=t.innerHTML;for(var r=t.attributes.length-1;r>=0;r--)e.setAttribute(t.attributes[r].name,t.attributes[r].value);return e}function n(t,e,r){var i,n,s,a,o,u=oldSrc=(t.getAttribute(e)||"").trim();2===arguments.length&&(r=t.closest("[x-src]")),u&&r&&!/^(\/\/|http:\/\/|https:\/\/)/i.test(u)&&(o=h(r.getAttribute("x-src")),i=(O||o).replace(/^\/+/,""),n=new RegExp("^((.){0,2}/)*"+i),n.test(u)?u=u.replace(n,O||o):"/"!==u[0]&&(s=r&&r.getAttribute("x-src")||"",a=s.substring(0,s.lastIndexOf("/")+1)||(O||o)+"/",u=(a+u).replace(/\/\.?\//,"/"))),u!==oldSrc&&t.setAttribute(e,u)}function s(t,s){e("script:not([processed])",t).forEach(function(t){t.setAttribute("processed",""),s&&t.setAttribute("await","");var e=i(t);if(e.hasAttribute("src")){n(e,"src",t.closest("[x-src]"));var a=e.getAttribute("src");!/\.js$/i.test(a)&&e.setAttribute("src",a+".js");var o=!e.hasAttribute("await");!s&&o?t.parentNode.replaceChild(e,t):(r(t,"src","x-src"),p(e))}else t.parentNode.replaceChild(e,t)})}function a(t){e('link[rel="stylesheet"][href]:not([processed])',t).forEach(function(t){n(t,"href"),t.setAttribute("processed","")}),e("img[src]:not([processed])",t).forEach(function(t){n(t,"src"),t.setAttribute("processed","")})}function o(){var t,e=(j.body.getAttribute("hash-error")||"").toLowerCase(),r=F.origin+F.pathname+F.search;"url"==e?(t="Page_route["+S.substring(1)+"]_not_found!_Redirected_to_this_page_root.",r=F.origin+F.pathname+"?_error="+t+F.search.replace(/^\?/,"&")):(t="Page route[#"+S.substring(1)+"] not found! Redirecting to this page root.",alert(t)),F.href=r}function u(t,r){if(H)if(t=t||S,t){var i=e('[url-hash="'+t+'"][x-target^="#"],[href="'+t+'"]');if(i.length)r&&i[0].setAttribute("skip-hash-update","1"),(!r||M&&r==S)&&(S=""),k=_,d.call(i[0],!0,r);else if(!T)if(S.indexOf($)>0){var n=(q&&q.split($)||[]).length,s=C[n];s||n<=C.length?(q+=(q?$:"")+s,M=e('[url-hash="'+q+'"][x-target^="#"]').length?0:250,setTimeout(function(){u(q,S)},M)):o()}else if(!A().length){var a=j.querySelector(S);a?(a.scrollIntoView(!0),S=""):o()}}else{var c=e("[skip-on-hash]");c.length&&(c.forEach(function(t){t.removeAttribute("skip-on-hash")}),v())}}function c(t,e){T--;var r=t.getAttribute("x-js");if(r&&(e+='<script src="'+r+'"></script>',t.removeAttribute("x-js")),"SCRIPT"==t.tagName){if(e.trim()){var i=j.createElement("script");i.id=(new Date).getMilliseconds(),i.text=e,j.head.appendChild(i).parentNode.removeChild(i)}}else{var n=t.hasAttribute("replace")||t.tagName.indexOf("REPLACE")>=0,o=n?t.parentNode:t,c=n?"outerHTML":"innerHTML",l=t.hasAttribute("await");e=e||"",t[c]=e,a(o),s(o,l),v(o)}u()}function l(){if(4==this.readyState){var t=this.status,e=t>=200&&t<300||304==t?this.responseText:"Cannot GET "+this.responseURL;c(this.targetEl,e)}}function h(t){var e="";if(t.indexOf("/")>=0){var r=t.indexOf("/"),i=t.indexOf("/",r+1);e=("/"===t[0]||"."===t[0])&&i>r?t.substring(0,i):t.substring(0,r)}return e}function f(t){"?"===O&&t.indexOf("/")>=0&&(O=h(t))}function g(t){var e,r,i=(t||"").trim(),n="";return/^(\/\/|http:\/\/|https:\/\/)/i.test(i)||(n=/\+$/.test(i)?"+":"",n&&(i=i.substring(0,i.length-1)),f(i),O&&(/^[^a-z0-9_\.\/]/gi.test(i[0])?i=i.substring(1):(e=O.replace(/^\/+/,""),r=new RegExp("^((.){0,2}/)*"+e),i=r.test(i)?i.replace(r,O):(O+"/"+i).replace(/\/\.?\//,"/"))),R&&!new RegExp(R+"$").test(i)&&(i="/"==i[i.length-1]?i.substring(0,i.length-1):i+R)),i+n}function p(t,e){if(e=g(e||t.getAttribute("src")),t.setAttribute("x-src",e),t.removeAttribute("src"),e){T++,/\+$/.test(e)&&(//appendScript
t.setAttribute("x-js",e.replace(/\.[a-z]{3,4}\+$/,".js")),e=e.substring(0,e.length-1));var r=new XMLHttpRequest;r.targetEl=t,r.onreadystatechange=l,r.open("GET",e,!t.hasAttribute("await")),r.send()}}function b(t){if(H){if(!t.getAttribute("skip-hash-update")){var e=t.getAttribute("url-hash");if("#"!=e&&k!=e){k=e;try{history.pushState(null,e,e)}catch(t){}}}t.removeAttribute("skip-hash-update")}}function d(t,e){var r=this;if(t&&e&&"FORM"!==r.tagName)r.click();else{if("FORM"==r.tagName&&!r.checkValidity())return r.reportValidity(),!1;var i=r.getAttribute("if");if(i){var n=i.indexOf("("),s=(n>0?i.substring(0,n):i).replace(/\s/g,"");if(s){var a;try{a=window[s].call(r)}catch(t){console.error("Function NOT Found:",s)}if(!a)return!1}}var o=j.querySelector(r.getAttribute("x-target"));if(o){o[r.hasAttribute("replace")?"setAttribute":"removeAttribute"]("replace",""),r.hasAttribute("await")&&o.setAttribute("await",""),r.hasAttribute("async")&&o.removeAttribute("await",""),b(r);var u=r.getAttribute("x-href").substring(1);/^[! ]/.test(u)&&(u=u.substring(1).trim()),p(o,u)}else console.warn("Target element not found. Invalid target specified in element",r)}}function A(t){return t=t||j,e("[src]"+"audio embed iframe img input script source track video [processed] [skip-on-hash]".split(" ").map(function(t){return":not("+t+")"}).join(""),t)}function v(t){t=t||j;var i=A(t);i.forEach(function(t){n(t,"src"),t.setAttribute("processed",""),p(t)}),e("form:not([onsubmit]):not([href])",t).forEach(function(t){!t.getAttribute("action")&&t.setAttribute("onsubmit","return false;")}),e('[href^="#"][target^="#"]',t).forEach(function(t){r(t,"target","x-target"),r(t,"href","x-href"),t.setAttribute("href","javascript:;");var e=t.getAttribute("url-hash")||t.getAttribute("x-href");!/^#/.test(e)&&(e="#"+e),/^#[! ]+/.test(e)&&(e="#"),e=e.replace(/[+ ]/g,"").replace(new RegExp("\\"+$+"+$"),""),t.setAttribute("url-hash",e);var i="FORM"==t.tagName,n=i?"submit":"click",s=(t.getAttribute("on")||n).replace(/[^a-z]/gi,"_");i&&!t.getAttribute("onsubmit")&&t.setAttribute("onsubmit","return false;"),s.split("_").forEach(function(e){e=e.trim().toLowerCase(),e.length>2&&(e=e.replace(/^on/,""),t.addEventListener(e,d))})}),!i.length&&w()}function m(){if(4==this.readyState){var t=this.status,e=t>=200&&t<300||304==t?this.responseText:'{"error":"Failed: [GET]'+this.responseURL+'", "status": '+t+"}";this.callbackFn(JSON.parse(e))}}function x(t,e){var r=new XMLHttpRequest;r.callbackFn=e,r.onreadystatechange=m,r.open("GET",t),r.send()}function y(t,r,i){var n=e(r)[0];n?("function"==typeof i&&G.push(i),p(n,t)):console.error("Target container not found.",r)}function E(t,e){"function"==typeof t&&(G.push({fn:t,delay:e||0}),w())}function w(t){T||A().length||!G.length||void 0!==t&&!t||(N=G.shift(),setTimeout(function(){var e=N.fn(t);void 0!==e&&!e&&(G=[]),w(e)},N.delay))}function L(){T=0,S=F.hash||"",C=H&&S&&S.split($)||[],O=(j.body.getAttribute("components-loc")||"").replace(/^\.\//,"").replace(/\/+$/g,"").trim(),R=(j.body.getAttribute("components-ext")||"").trim(),v(),setTimeout(function(){new MutationObserver(function(t){t&&t[0]&&"childList"===t[0].type&&t[0].target&&v(t[0].target)}).observe(j,{childList:!0,subtree:!0})})}var O,R,T,S,k,_,C,M,N,j=document,F=j.location,$="/",q="",H="off"!=(j.body.getAttribute("url-hash")||"").toLowerCase(),G=[];H&&(window.onhashchange=function(){_=F.hash||"",_?_!=k&&(S=_,u()):(F.href.indexOf("#")<0&&F.reload(),k="#")}),"complete"==j.readyState||"loading"!=j.readyState&&!j.documentElement.doScroll?L():j.addEventListener("DOMContentLoaded",L),t.alt=t.aif={load:y,onReady:E,getData:x}})(this);