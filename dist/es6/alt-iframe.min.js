/**
 * alt-iframe
 * - A simple native JavaScript (ES6+) utility library to include partial HTML(s).
 * - You don't need a framework or jQuery!!!
 *
 * version: 1.5.0-ES6
 *
 * License: MIT
 *
 * USAGE:
 * see example at https://github.com/FrontEndNeo/alt-iframe
*/
(function(t){function e(t,e){return e="string"==typeof e&&E.querySelector(e)||e||E,Array.prototype.slice.call(e.querySelectorAll(t))}function r(t,e,r){t.setAttribute(r,t.getAttribute(e)),t.removeAttribute(e)}function i(t){let e=E.createElement("script");e.text=t.innerHTML.replace(/&gt;/gi,">").replace(/&lt;/gi,"<").replace(/&amp;/gi,"&").replace(/&quot;/gi,'"').replace(/&apos;/gi,"'");for(let r=t.attributes.length-1;r>=0;r--)e.setAttribute(t.attributes[r].name,t.attributes[r].value);return e}function a(t,a){e("x-script:not([processed])",t).forEach(t=>{t.setAttribute("processed",""),a&&t.setAttribute("await","");let e=i(t);if(e.hasAttribute("src")){let i=!e.hasAttribute("await");!a&&i?t.parentNode.replaceChild(e,t):(r(t,"src","x-src"),l(e))}else t.parentNode.replaceChild(e,t)})}function s(){let t,e=(E.body.getAttribute("hash-error")||"").toLowerCase(),r=L.origin+L.pathname+L.search;"url"==e?(t="Page_route["+m.substring(1)+"]_not_found!_Redirected_to_this_page_root.",r=L.origin+L.pathname+"?_error="+t+L.search.replace(/^\?/,"&")):(t="Page route[#"+m.substring(1)+"] not found! Redirecting to this page root.",alert(t)),L.href=r}function n(t,r){if(C)if(t=t||m,t){let i=e('[url-hash="'+t+'"][x-target^="#"]');if(i.length)r&&i[0].setAttribute("skip-hash-update","1"),(!r||v&&r==m)&&(m=""),x=w,h.call(i[0]);else if(!A)if(m.indexOf(_)>0){let t=(k&&k.split(_)||[]).length,r=y[t];r||t<=y.length?(k+=(k?_:"")+r,v=e('[url-hash="'+k+'"][x-target^="#"]').length?0:250,setTimeout(()=>{n(k,m)},v)):s()}else if(!g().length){let t=E.querySelector(m);t?(t.scrollIntoView(!0),m=""):s()}}else{let t=e("[skip-on-hash]");t.length&&(t.forEach(t=>{t.removeAttribute("skip-on-hash")}),b())}}function o(t,e){A--;let r=t.getAttribute("x-js");if(r&&(e+='<script src="'+r+'"></script>',t.removeAttribute("x-js")),"SCRIPT"==t.tagName){if(e.trim()){let t=E.createElement("script");t.id=(new Date).getMilliseconds(),t.text=e,E.head.appendChild(t).parentNode.removeChild(t)}}else if(e=(e||"").replace(/<(\/)*script/gi,"<$1x-script"),t.tagName.indexOf("REPLACE")>=0||t.hasAttribute("replace")){let r=t.parentNode,i=t.hasAttribute("await");t.outerHTML=e,a(r,i),b(r)}else t.innerHTML=e,a(t,t.hasAttribute("await")),b(t);n()}function u(t){let e=(t||"").trim(),r=/\+$/.test(e)?"+":"";return r&&(e=e.substring(0,e.length-1)),f&&(e=/^[^a-z0-9_]/gi.test(e[0])?e.substring(1):f+"/"+e),d&&(e="/"==e[e.length-1]?e.substring(0,e.length-1):e+d),e+r}function l(t,e){e=u(e||t.getAttribute("src")),t.setAttribute("x-src",e),t.removeAttribute("src"),e&&(A++,/\+$/.test(e)&&(//appendScript
t.setAttribute("x-js",e.replace(/\.[a-z]{3,4}\+$/,".js")),e=e.substring(0,e.length-1)),t.hasAttribute("await")?(async()=>{const r=await fetch(e).catch(t=>null);r&&r.ok&&o(t,await r.text())})():fetch(e).then(t=>t.text()).then(e=>o(t,e)).catch(t=>null))}function c(t){if(C){if(!t.getAttribute("skip-hash-update")){let e=t.getAttribute("url-hash");if("#"!=e&&x!=e){x=e;try{history.pushState(null,e,e)}catch(t){}}}t.removeAttribute("skip-hash-update")}}function h(){let t=this;if("FORM"==t.tagName&&!t.checkValidity())return t.reportValidity(),!1;let e=t.getAttribute("if");if(e){let r=e.indexOf("("),i=(r>0?e.substring(0,r):e).replace(/\s/g,"");if(i){let e;try{e=window[i].call(t)}catch(t){console.error("Function NOT Found:",i)}if(!e)return!1}}let r=E.querySelector(t.getAttribute("x-target"));if(r){r[t.hasAttribute("replace")?"setAttribute":"removeAttribute"]("replace",""),t.hasAttribute("await")&&r.setAttribute("await",""),t.hasAttribute("async")&&r.removeAttribute("await",""),c(t);let e=t.getAttribute("x-href").substring(1);/^[! ]/.test(e)&&(e=e.substring(1).trim()),l(r,e)}else console.warn("Target element not found. Invalid target specified in element",t)}function g(t){return t=t||E,e("[src]"+"audio embed iframe img input script source track video x-script [processed] [skip-on-hash]".split(" ").map(function(t){return":not("+t+")"}).join(""),t)}function b(t){t=t||E,g(t).forEach(t=>{t.setAttribute("processed",""),l(t)}),e("form:not([onsubmit]):not([href])",t).forEach(t=>{!t.getAttribute("action")&&t.setAttribute("onsubmit","return false;")}),e('[href^="#"][target^="#"]',t).forEach(t=>{r(t,"target","x-target"),r(t,"href","x-href"),t.setAttribute("href","javascript:;");let e=t.getAttribute("url-hash")||t.getAttribute("x-href");!/^#/.test(e)&&(e="#"+e),/^#[! ]+/.test(e)&&(e="#"),e=e.replace(/[+ ]/g,"").replace(new RegExp("\\"+_+"+$"),""),t.setAttribute("url-hash",e);let i="FORM"==t.tagName,a=i?"submit":"click",s=(t.getAttribute("on")||a).replace(/[^a-z]/gi,"_");i&&!t.getAttribute("onsubmit")&&t.setAttribute("onsubmit","return false;"),s.split("_").forEach(e=>{e=e.trim().toLowerCase(),e.length>2&&(e=e.replace(/^on/,""),t.addEventListener(e,h))})})}function p(){A=0,m=L.hash||"",y=C&&m&&m.split(_)||[],f=(E.body.getAttribute("components-loc")||"").replace(/\/+$/g,"").trim(),d=(E.body.getAttribute("components-ext")||"").trim(),b(),setTimeout(function(){new MutationObserver(t=>{t&&t[0]&&"childList"===t[0].type&&t[0].target&&b(t[0].target)}).observe(E,{childList:!0,subtree:!0})})}let f,d,A,m,x,w,y,v,E=document,L=E.location,_="/",k="",C="off"!=(E.body.getAttribute("url-hash")||"").toLowerCase();C&&(window.onhashchange=function(){w=L.hash||"",w?w!=x&&(m=w,n()):(L.href.indexOf("#")<0&&L.reload(),x="#")}),"complete"==E.readyState||"loading"!=E.readyState&&!E.documentElement.doScroll?p():E.addEventListener("DOMContentLoaded",p)})();