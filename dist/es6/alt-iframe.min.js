/**
 * alt-iframe
 * - A simple native JavaScript (ES6+) utility library to include partial HTML(s).
 * - You don't need a framework or jQuery!!!
 *
 * version: 1.8.2-ES6
 *
 * License: MIT
 *
 * USAGE:
 * see example at https://github.com/FrontEndNeo/alt-iframe
*/
(function(t){function e(t,e){return e="string"==typeof e&&N.querySelector(e)||e||N,Array.prototype.slice.call(e.querySelectorAll(t))}function r(t,e,r){t.setAttribute(r,t.getAttribute(e)),t.removeAttribute(e)}function i(t){let e=N.createElement("script");e.text=t.innerHTML;for(let r=t.attributes.length-1;r>=0;r--)e.setAttribute(t.attributes[r].name,t.attributes[r].value);return e}function s(t,e,r){let i,s,n,a,o,u=oldSrc=(t.getAttribute(e)||"").trim();2===arguments.length&&(r=t.closest("[x-src]")),u&&r&&!/^(\/\/|http:\/\/|https:\/\/)/i.test(u)&&(o=l(r.getAttribute("x-src")),i=(v||o).replace(/^\/+/,""),s=new RegExp("^((.){0,2}/)*"+i),s.test(u)?u=u.replace(s,v||o):"/"!==u[0]&&(n=r&&r.getAttribute("x-src")||"",a=n.substring(0,n.lastIndexOf("/")+1)||(v||o)+"/",u=(a+u).replace(/\/\.?\//,"/"))),u!==oldSrc&&t.setAttribute(e,u)}function n(t,n){e("script:not([processed])",t).forEach(t=>{t.setAttribute("processed",""),n&&t.setAttribute("await","");let e=i(t);if(e.hasAttribute("src")){s(e,"src",t.closest("[x-src]"));let i=e.getAttribute("src");!/\.js$/i.test(i)&&e.setAttribute("src",i+".js");let a=!e.hasAttribute("await");!n&&a?t.parentNode.replaceChild(e,t):(r(t,"src","x-src"),g(e))}else t.parentNode.replaceChild(e,t)})}function a(t){e('link[rel="stylesheet"][href]:not([processed])',t).forEach(t=>{s(t,"href"),t.setAttribute("processed","")}),e("img[src]:not([processed])",t).forEach(t=>{!/^data:/i.test(t.getAttribute("src"))&&s(t,"src"),t.setAttribute("processed","")})}function o(){let t,e=(N.body.getAttribute("hash-error")||"").toLowerCase(),r=j.origin+j.pathname+j.search;"url"==e?(t="Page_route["+L.substring(1)+"]_not_found!_Redirected_to_this_page_root.",r=j.origin+j.pathname+"?_error="+t+j.search.replace(/^\?/,"&")):(t="Page route[#"+L.substring(1)+"] not found! Redirecting to this page root.",alert(t)),j.href=r}function u(t,r){if($)if(t=t||L,t){let i=e('[url-hash="'+t+'"][x-target^="#"],[href="'+t+'"]');if(i.length)r&&i[0].setAttribute("skip-hash-update","1"),(!r||S&&r==L)&&(L=""),R=T,p.call(i[0],!0,r);else if(!k)if(L.indexOf(M)>0){let t=(F&&F.split(M)||[]).length,r=_[t];r||t<=_.length?(F+=(F?M:"")+r,S=e('[url-hash="'+F+'"][x-target^="#"]').length?0:250,setTimeout(()=>{u(F,L)},S)):o()}else if(!d().length){let t=N.querySelector(L);t?(t.scrollIntoView(!0),L=""):o()}}else{let t=e("[skip-on-hash]");t.length&&(t.forEach(t=>{t.removeAttribute("skip-on-hash")}),A())}}function c(t,e){k--;let r=t.getAttribute("x-js");if(r&&(e+='<script src="'+r+'"></script>',t.removeAttribute("x-js")),"SCRIPT"==t.tagName){if(e.trim()){let t=N.createElement("script");t.id=(new Date).getMilliseconds(),t.text=e,N.head.appendChild(t).parentNode.removeChild(t)}}else{let r=t.hasAttribute("replace")||t.tagName.indexOf("REPLACE")>=0,i=r?t.parentNode:t,s=r?"outerHTML":"innerHTML",o=t.hasAttribute("await");e=e||"",t[s]=e,a(i),n(i,o),A(i)}u()}function l(t){let e="";if(t.indexOf("/")>=0){let r=t.indexOf("/"),i=t.indexOf("/",r+1);e=("/"===t[0]||"."===t[0])&&i>r?t.substring(0,i):t.substring(0,r)}return e}function h(t){"?"===v&&t.indexOf("/")>=0&&(v=l(t))}function f(t){let e,r,i=(t||"").trim(),s="";return/^(\/\/|http:\/\/|https:\/\/)/i.test(i)||(s=/\+$/.test(i)?"+":"",s&&(i=i.substring(0,i.length-1)),h(i),v&&(/^[^a-z0-9_\.\/]/gi.test(i[0])?i=i.substring(1):(e=v.replace(/^\/+/,""),r=new RegExp("^((.){0,2}/)*"+e),i=r.test(i)?i.replace(r,v):(v+"/"+i).replace(/\/\.?\//,"/"))),O&&!new RegExp(O+"$").test(i)&&(i="/"==i[i.length-1]?i.substring(0,i.length-1):i+O)),i+s}function g(t,e){e=f(e||t.getAttribute("src")),t.setAttribute("x-src",e),t.removeAttribute("src"),e&&(k++,/\+$/.test(e)&&(//appendScript
t.setAttribute("x-js",e.replace(/\.[a-z]{3,4}\+$/,".js")),e=e.substring(0,e.length-1)),t.hasAttribute("await")?(async()=>{const r=await fetch(e).catch(t=>null);r&&r.ok&&c(t,await r.text())})():fetch(e).then(t=>t.text()).then(e=>c(t,e)).catch(t=>null))}function b(t){if($){if(!t.getAttribute("skip-hash-update")){let e=t.getAttribute("url-hash");if("#"!=e&&R!=e){R=e;try{history.pushState(null,e,e)}catch(t){}}}t.removeAttribute("skip-hash-update")}}function p(t,e){let r=this;if(t&&e&&"FORM"!==r.tagName)return void r.click();if("FORM"==r.tagName&&!r.checkValidity())return r.reportValidity(),!1;let i=r.getAttribute("if");if(i){let t=i.indexOf("("),e=(t>0?i.substring(0,t):i).replace(/\s/g,"");if(e){let t;try{t=window[e].call(r)}catch(t){console.error("Function NOT Found:",e)}if(!t)return!1}}let s=N.querySelector(r.getAttribute("x-target"));if(s){s[r.hasAttribute("replace")?"setAttribute":"removeAttribute"]("replace",""),r.hasAttribute("await")&&s.setAttribute("await",""),r.hasAttribute("async")&&s.removeAttribute("await",""),b(r);let t=r.getAttribute("x-href").substring(1);/^[! ]/.test(t)&&(t=t.substring(1).trim()),g(s,t)}else console.warn("Target element not found. Invalid target specified in element",r)}function d(t){return t=t||N,e("[src]"+"audio embed iframe img input script source track video [processed] [skip-on-hash]".split(" ").map(function(t){return":not("+t+")"}).join(""),t)}function A(t){t=t||N;let i=d(t);i.forEach(t=>{s(t,"src"),t.setAttribute("processed",""),g(t)}),e("form:not([onsubmit]):not([href])",t).forEach(t=>{!t.getAttribute("action")&&t.setAttribute("onsubmit","return false;")}),e('[href^="#"][target^="#"]',t).forEach(t=>{r(t,"target","x-target"),r(t,"href","x-href"),t.setAttribute("href","javascript:;");let e=t.getAttribute("url-hash")||t.getAttribute("x-href");!/^#/.test(e)&&(e="#"+e),/^#[! ]+/.test(e)&&(e="#"),e=e.replace(/[+ ]/g,"").replace(new RegExp("\\"+M+"+$"),""),t.setAttribute("url-hash",e);let i="FORM"==t.tagName,s=i?"submit":"click",n=(t.getAttribute("on")||s).replace(/[^a-z]/gi,"_");i&&!t.getAttribute("onsubmit")&&t.setAttribute("onsubmit","return false;"),n.split("_").forEach(e=>{e=e.trim().toLowerCase(),e.length>2&&(e=e.replace(/^on/,""),t.addEventListener(e,p))})}),!i.length&&w()}function m(t,e){return fetch(t).then(e=>{let r=e.status;return e.ok&&(r>=200&&r<300||304==r)?e.json():{error:"Failed: [GET]"+t,status:r}}).then(t=>e(t)).catch(r=>e({error:"Failed: [GET]"+t,e:r}))}function x(t,r,i){let s=e(r)[0];s?("function"==typeof i&&q.push(i),g(s,t)):console.error("Target container not found.",r)}function y(t,e){"function"==typeof t&&(q.push({fn:t,delay:e||0}),w())}function w(t){k||d().length||!q.length||void 0!==t&&!t||(C=q.shift(),setTimeout(()=>{let e=C.fn(t);void 0!==e&&!e&&(q=[]),w(e)},C.delay))}function E(){k=0,L=j.hash||"",_=$&&L&&L.split(M)||[],v=(N.body.getAttribute("components-loc")||"").replace(/^\.\//,"").replace(/\/+$/g,"").trim(),O=(N.body.getAttribute("components-ext")||"").trim(),A(),setTimeout(function(){new MutationObserver(t=>{t&&t[0]&&"childList"===t[0].type&&t[0].target&&A(t[0].target)}).observe(N,{childList:!0,subtree:!0})})}let v,O,k,L,R,T,_,S,C,N=document,j=N.location,M="/",F="",$="off"!=(N.body.getAttribute("url-hash")||"").toLowerCase(),q=[];$&&(window.onhashchange=function(){T=j.hash||"",T?T!=R&&(L=T,u()):(j.href.indexOf("#")<0&&j.reload(),R="#")}),"complete"==N.readyState||"loading"!=N.readyState&&!N.documentElement.doScroll?E():N.addEventListener("DOMContentLoaded",E),t.alt=t.aif={load:x,onReady:y,getData:m}})(this);