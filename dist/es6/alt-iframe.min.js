/**
 * alt-iframe
 * - A simple native JavaScript (ES6+) utility library to include partial HTML(s).
 * - You don't need a framework or jQuery!!!
 *
 * version: 1.7.0-ES6
 *
 * License: MIT
 *
 * USAGE:
 * see example at https://github.com/FrontEndNeo/alt-iframe
*/
(function(t){function e(t,e){return e="string"==typeof e&&C.querySelector(e)||e||C,Array.prototype.slice.call(e.querySelectorAll(t))}function r(t,e,r){t.setAttribute(r,t.getAttribute(e)),t.removeAttribute(e)}function i(t){let e=C.createElement("script");e.text=t.innerHTML.replace(/&gt;/gi,">").replace(/&lt;/gi,"<").replace(/&amp;/gi,"&").replace(/&quot;/gi,'"').replace(/&apos;/gi,"'");for(let r=t.attributes.length-1;r>=0;r--)e.setAttribute(t.attributes[r].name,t.attributes[r].value);return e}function n(t,n){
// getElements('x-script:not([processed])', context).forEach(xScript=>{
e("script:not([processed])",t).forEach(t=>{t.setAttribute("processed",""),n&&t.setAttribute("await","");let e=i(t);if(e.hasAttribute("src")){let i=!e.hasAttribute("await");!n&&i?t.parentNode.replaceChild(e,t):(r(t,"src","x-src"),l(e))}else t.parentNode.replaceChild(e,t)})}function a(){let t,e=(C.body.getAttribute("hash-error")||"").toLowerCase(),r=N.origin+N.pathname+N.search;"url"==e?(t="Page_route["+v.substring(1)+"]_not_found!_Redirected_to_this_page_root.",r=N.origin+N.pathname+"?_error="+t+N.search.replace(/^\?/,"&")):(t="Page route[#"+v.substring(1)+"] not found! Redirecting to this page root.",alert(t)),N.href=r}function s(t,r){if(R)if(t=t||v,t){let i=e('[url-hash="'+t+'"][x-target^="#"],[href="'+t+'"]');if(i.length)r&&i[0].setAttribute("skip-hash-update","1"),(!r||T&&r==v)&&(v=""),E=k,h.call(i[0],!0,r);else if(!x)if(v.indexOf(O)>0){let t=(M&&M.split(O)||[]).length,r=L[t];r||t<=L.length?(M+=(M?O:"")+r,T=e('[url-hash="'+M+'"][x-target^="#"]').length?0:250,setTimeout(()=>{s(M,v)},T)):a()}else if(!f().length){let t=C.querySelector(v);t?(t.scrollIntoView(!0),v=""):a()}}else{let t=e("[skip-on-hash]");t.length&&(t.forEach(t=>{t.removeAttribute("skip-on-hash")}),g())}}function o(t,e){x--;let r=t.getAttribute("x-js");if(r&&(e+='<script src="'+r+'"></script>',t.removeAttribute("x-js")),"SCRIPT"==t.tagName){if(e.trim()){let t=C.createElement("script");t.id=(new Date).getMilliseconds(),t.text=e,C.head.appendChild(t).parentNode.removeChild(t)}}else
// .replace(/<(\/)*script/gi, '<$1x-script');
if(e=e||"",t.tagName.indexOf("REPLACE")>=0||t.hasAttribute("replace")){let r=t.parentNode,i=t.hasAttribute("await");t.outerHTML=e,n(r,i),g(r)}else t.innerHTML=e,n(t,t.hasAttribute("await")),g(t);s()}function u(t){let e=(t||"").trim(),r="";return/^(\/\/|http:\/\/|https:\/\/)/i.test(e)||(r=/\+$/.test(e)?"+":"",r&&(e=e.substring(0,e.length-1)),y&&(e=/^[^a-z0-9_]/gi.test(e[0])?e.substring(1):y+"/"+e),w&&(e="/"==e[e.length-1]?e.substring(0,e.length-1):e+w)),e+r}function l(t,e){e=u(e||t.getAttribute("src")),t.setAttribute("x-src",e),t.removeAttribute("src"),e&&(x++,/\+$/.test(e)&&(//appendScript
t.setAttribute("x-js",e.replace(/\.[a-z]{3,4}\+$/,".js")),e=e.substring(0,e.length-1)),t.hasAttribute("await")?(async()=>{const r=await fetch(e).catch(t=>null);r&&r.ok&&o(t,await r.text())})():fetch(e).then(t=>t.text()).then(e=>o(t,e)).catch(t=>null))}function c(t){if(R){if(!t.getAttribute("skip-hash-update")){let e=t.getAttribute("url-hash");if("#"!=e&&E!=e){E=e;try{history.pushState(null,e,e)}catch(t){}}}t.removeAttribute("skip-hash-update")}}function h(t,e){let r=this;if(t&&e&&"FORM"!==r.tagName)return void r.click();if("FORM"==r.tagName&&!r.checkValidity())return r.reportValidity(),!1;let i=r.getAttribute("if");if(i){let t=i.indexOf("("),e=(t>0?i.substring(0,t):i).replace(/\s/g,"");if(e){let t;try{t=window[e].call(r)}catch(t){console.error("Function NOT Found:",e)}if(!t)return!1}}let n=C.querySelector(r.getAttribute("x-target"));if(n){n[r.hasAttribute("replace")?"setAttribute":"removeAttribute"]("replace",""),r.hasAttribute("await")&&n.setAttribute("await",""),r.hasAttribute("async")&&n.removeAttribute("await",""),c(r);let t=r.getAttribute("x-href").substring(1);/^[! ]/.test(t)&&(t=t.substring(1).trim()),l(n,t)}else console.warn("Target element not found. Invalid target specified in element",r)}function f(t){return t=t||C,e("[src]"+"audio embed iframe img input script source track video [processed] [skip-on-hash]".split(" ").map(function(t){return":not("+t+")"}).join(""),t)}function g(t){t=t||C;let i=f(t);i.forEach(t=>{t.setAttribute("processed",""),l(t)}),e("form:not([onsubmit]):not([href])",t).forEach(t=>{!t.getAttribute("action")&&t.setAttribute("onsubmit","return false;")}),e('[href^="#"][target^="#"]',t).forEach(t=>{r(t,"target","x-target"),r(t,"href","x-href"),t.setAttribute("href","javascript:;");let e=t.getAttribute("url-hash")||t.getAttribute("x-href");!/^#/.test(e)&&(e="#"+e),/^#[! ]+/.test(e)&&(e="#"),e=e.replace(/[+ ]/g,"").replace(new RegExp("\\"+O+"+$"),""),t.setAttribute("url-hash",e);let i="FORM"==t.tagName,n=i?"submit":"click",a=(t.getAttribute("on")||n).replace(/[^a-z]/gi,"_");i&&!t.getAttribute("onsubmit")&&t.setAttribute("onsubmit","return false;"),a.split("_").forEach(e=>{e=e.trim().toLowerCase(),e.length>2&&(e=e.replace(/^on/,""),t.addEventListener(e,h))})}),!i.length&&A()}function p(t,e){return fetch(t).then(e=>{let r=e.status;return e.ok&&(r>=200&&r<300||304==r)?e.json():{error:"Failed: [GET]"+t,status:r}}).then(t=>e(t)).catch(r=>e({error:"Failed: [GET]"+t,e:r}))}function b(t,r,i){let n=e(r)[0];n?("function"==typeof i&&S.push(i),l(n,t)):console.error("Target container not found.",r)}function d(t,e){"function"==typeof t&&(S.push({fn:t,delay:e||0}),A())}function A(t){x||f().length||!S.length||void 0!==t&&!t||(_=S.shift(),setTimeout(()=>{let e=_.fn(t);void 0!==e&&!e&&(S=[]),A(e)},_.delay))}function m(){x=0,v=N.hash||"",L=R&&v&&v.split(O)||[],y=(C.body.getAttribute("components-loc")||"").replace(/\/+$/g,"").trim(),w=(C.body.getAttribute("components-ext")||"").trim(),g(),setTimeout(function(){new MutationObserver(t=>{t&&t[0]&&"childList"===t[0].type&&t[0].target&&g(t[0].target)}).observe(C,{childList:!0,subtree:!0})})}let y,w,x,v,E,k,L,T,_,C=document,N=C.location,O="/",M="",R="off"!=(C.body.getAttribute("url-hash")||"").toLowerCase(),S=[];R&&(window.onhashchange=function(){k=N.hash||"",k?k!=E&&(v=k,s()):(N.href.indexOf("#")<0&&N.reload(),E="#")}),"complete"==C.readyState||"loading"!=C.readyState&&!C.documentElement.doScroll?m():C.addEventListener("DOMContentLoaded",m),t.alt=t.aif={load:b,onReady:d,getData:p}})(this);